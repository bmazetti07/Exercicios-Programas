{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/home/mazetti/Bruno/eps/Computa\\xE7\\xE3o M\\xF3vel/EP1/app/context/AudioProvider.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component, createContext } from 'react';\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport * as MediaLibrary from 'expo-media-library';\nimport MaterialIcons from \"@expo/vector-icons/MaterialIcons\";\nimport { DataProvider } from 'recyclerlistview';\nexport var AudioContext = createContext();\nexport var AudioProvider = function (_Component) {\n  _inherits(AudioProvider, _Component);\n\n  var _super = _createSuper(AudioProvider);\n\n  function AudioProvider(props) {\n    var _this;\n\n    _classCallCheck(this, AudioProvider);\n\n    _this = _super.call(this, props);\n\n    _this.permissionAlert = function () {\n      Alert.alert(\"É necessário permissão!\", \"Esse aplicativo precisa ler arquivos de áudio!\", [{\n        text: 'Garantir Permissão',\n        onPress: function onPress() {\n          return _this.getPermission();\n        }\n      }, {\n        text: 'Negar Permissão',\n        onPress: function onPress() {\n          return _this.permissionAlert();\n        }\n      }]);\n    };\n\n    _this.getAudioFiles = function _callee() {\n      var _this$state, dataProvider, audioFiles, media;\n\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this$state = _this.state, dataProvider = _this$state.dataProvider, audioFiles = _this$state.audioFiles;\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(MediaLibrary.getAssetsAsync({\n                mediaType: 'audio'\n              }));\n\n            case 3:\n              media = _context.sent;\n              _context.next = 6;\n              return _regeneratorRuntime.awrap(MediaLibrary.getAssetsAsync({\n                mediaType: 'audio',\n                first: media.totalCount,\n                sortBy: MediaLibrary.SortBy.modificationTime\n              }));\n\n            case 6:\n              media = _context.sent;\n\n              _this.setState(_objectSpread(_objectSpread({}, _this.state), {}, {\n                dataProvider: dataProvider.cloneWithRows([].concat(_toConsumableArray(audioFiles), _toConsumableArray(media.assets))),\n                audioFiles: [].concat(_toConsumableArray(audioFiles), _toConsumableArray(media.assets))\n              }));\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.getPermission = function _callee2() {\n      var permission, _await$MediaLibrary$r, status, canAskAgain;\n\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _regeneratorRuntime.awrap(MediaLibrary.getPermissionsAsync());\n\n            case 2:\n              permission = _context2.sent;\n\n              if (permission.granted) {\n                _this.getAudioFiles();\n              }\n\n              if (!permission.canAskAgain && !permission.granted) {\n                _this.setState(_objectSpread(_objectSpread({}, _this.state), {}, {\n                  permissionError: true\n                }));\n              }\n\n              if (!(!permission.granted && permission.canAskAgain)) {\n                _context2.next = 14;\n                break;\n              }\n\n              _context2.next = 8;\n              return _regeneratorRuntime.awrap(MediaLibrary.requestPermissionsAsync());\n\n            case 8:\n              _await$MediaLibrary$r = _context2.sent;\n              status = _await$MediaLibrary$r.status;\n              canAskAgain = _await$MediaLibrary$r.canAskAgain;\n\n              if (status === 'denied' && canAskAgain) {\n                _this.permissionAlert();\n              }\n\n              if (status === 'granted') {\n                _this.getAudioFiles();\n              }\n\n              if (status === 'denied' && !canAskAgain) {\n                _this.setState(_objectSpread(_objectSpread({}, _this.state), {}, {\n                  permissionError: true\n                }));\n              }\n\n            case 14:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.updateState = function (prevState) {\n      var newState = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      _this.setState(_objectSpread(_objectSpread({}, prevState), newState));\n    };\n\n    _this.state = {\n      audioFiles: [],\n      permissionError: false,\n      dataProvider: new DataProvider(function (r1, r2) {\n        return r1 !== r2;\n      }),\n      playbackObj: null,\n      soundObj: null,\n      currentAudio: {}\n    };\n    return _this;\n  }\n\n  _createClass(AudioProvider, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getPermission();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state2 = this.state,\n          audioFiles = _this$state2.audioFiles,\n          dataProvider = _this$state2.dataProvider,\n          permissionError = _this$state2.permissionError,\n          playbackObj = _this$state2.playbackObj,\n          soundObj = _this$state2.soundObj,\n          currentAudio = _this$state2.currentAudio;\n      if (permissionError) return React.createElement(View, {\n        style: styles.container,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 9\n        }\n      }, React.createElement(MaterialIcons, {\n        name: \"error\",\n        size: 100,\n        color: 'red',\n        style: {\n          marginTop: 25\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 11\n        }\n      }), React.createElement(Text, {\n        style: styles.permissionDeniedText,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 11\n        }\n      }, \" O aplicativo n\\xE3o executar\\xE1, pois n\\xE3o h\\xE1 permiss\\xE3o de leitura de m\\xEDdia \"));\n      return React.createElement(AudioContext.Provider, {\n        value: {\n          audioFiles: audioFiles,\n          dataProvider: dataProvider,\n          playbackObj: playbackObj,\n          soundObj: soundObj,\n          currentAudio: currentAudio,\n          updateState: this.updateState\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 7\n        }\n      }, this.props.children);\n    }\n  }]);\n\n  return AudioProvider;\n}(Component);\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: '#222831'\n  },\n  permissionDeniedText: {\n    fontSize: 25,\n    textAlign: 'center',\n    color: '#fff'\n  }\n});\nexport default AudioProvider;","map":{"version":3,"sources":["/home/mazetti/Bruno/eps/Computação Móvel/EP1/app/context/AudioProvider.js"],"names":["React","Component","createContext","MediaLibrary","MaterialIcons","DataProvider","AudioContext","AudioProvider","props","permissionAlert","Alert","alert","text","onPress","getPermission","getAudioFiles","state","dataProvider","audioFiles","getAssetsAsync","mediaType","media","first","totalCount","sortBy","SortBy","modificationTime","setState","cloneWithRows","assets","getPermissionsAsync","permission","granted","canAskAgain","permissionError","requestPermissionsAsync","status","updateState","prevState","newState","r1","r2","playbackObj","soundObj","currentAudio","styles","container","marginTop","permissionDeniedText","children","StyleSheet","create","flex","justifyContent","alignItems","backgroundColor","fontSize","textAlign","color"],"mappings":"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","sourcesContent":["import React, { Component, createContext } from 'react';\nimport { Text, View, Alert, StyleSheet } from 'react-native';\nimport * as MediaLibrary from 'expo-media-library';\nimport MaterialIcons from 'react-native-vector-icons/MaterialIcons';\nimport { DataProvider } from 'recyclerlistview';\n\nexport const AudioContext = createContext()\nexport class AudioProvider extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      audioFiles: [],\n      permissionError: false,\n      dataProvider: new DataProvider((r1, r2) => r1 !== r2),\n      playbackObj: null,\n      soundObj: null,\n      currentAudio: {}\n    }\n  }\n\n  permissionAlert = () => {\n    Alert.alert(\"É necessário permissão!\", \"Esse aplicativo precisa ler arquivos de áudio!\", [{\n      text: 'Garantir Permissão',\n      onPress: () => this.getPermission()\n    }, {\n      text: 'Negar Permissão',\n      onPress: () => this.permissionAlert()\n    }])\n  }\n\n  getAudioFiles = async () => {\n    const { dataProvider, audioFiles } = this.state\n    let media = await MediaLibrary.getAssetsAsync({\n      mediaType: 'audio',\n    })\n\n    media = await MediaLibrary.getAssetsAsync({\n      mediaType: 'audio',\n      first: media.totalCount,\n      sortBy: MediaLibrary.SortBy.modificationTime\n    })\n\n    this.setState({ ...this.state, dataProvider: dataProvider.cloneWithRows([...audioFiles, ...media.assets]), audioFiles: [...audioFiles, ...media.assets] })\n  }\n\n  getPermission = async () => {\n    const permission = await MediaLibrary.getPermissionsAsync()\n\n    if (permission.granted) {\n      this.getAudioFiles()\n    }\n\n    if (!permission.canAskAgain && !permission.granted) {\n      this.setState({ ...this.state, permissionError: true })\n    }\n\n    if (!permission.granted && permission.canAskAgain) {\n      const { status, canAskAgain } = await MediaLibrary.requestPermissionsAsync()\n      if (status === 'denied' && canAskAgain) {\n        this.permissionAlert()\n      }\n\n      if (status === 'granted') {\n        this.getAudioFiles()\n      }\n\n      if (status === 'denied' && !canAskAgain) {\n        this.setState({ ...this.state, permissionError: true })\n      }\n    }\n  }\n\n  componentDidMount() {\n    this.getPermission()\n  }\n\n  updateState = (prevState, newState = {}) => {\n    this.setState({ ...prevState, ...newState })\n  }\n\n  render() {\n    const { audioFiles, dataProvider, permissionError, playbackObj, soundObj, currentAudio } = this.state\n\n    if (permissionError)\n      return (\n        <View style={styles.container}>\n          <MaterialIcons name=\"error\" size={100} color={'red'} style={{ marginTop: 25 }} />\n          <Text style={styles.permissionDeniedText}> O aplicativo não executará, pois não há permissão de leitura de mídia </Text>\n        </View>\n      )\n\n    return (\n      <AudioContext.Provider value={{\n        audioFiles,\n        dataProvider,\n        playbackObj,\n        soundObj,\n        currentAudio,\n        updateState: this.updateState\n      }}>\n        {this.props.children}\n      </AudioContext.Provider>\n    )\n  }\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: '#222831'\n  },\n\n  permissionDeniedText: {\n    fontSize: 25,\n    textAlign: 'center',\n    color: '#fff'\n  }\n})\n\nexport default AudioProvider\n"]},"metadata":{},"sourceType":"module"}